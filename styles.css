/* Limpieza: se removieron estilos de sugerencias (no se usan) */
/* =====================================================================
  MICARGA — styles.css (comentado)
   ---------------------------------------------------------------------
   - Diseño claro basado en la paleta del logo
   - Variables CSS para colores, sombras, radios y tokens reutilizables
   - Componentes principales: topbar, cards, botones, listas, chat, tracking y tabs
   ===================================================================== */

/* --------------------
   Paleta y design tokens
   -------------------- */
:root{
  /* Colores base (extraídos del logo) */
  --bg:#c0ced3;        /* Fondo general */
  --card:#ffffff;      /* Tarjetas / contenedores */
  --text:#0E2F44;      /* Azul oscuro del logo: color principal de texto */
  --muted:#5A6C79;     /* Texto secundario/desaturado */

  --primary:#0E2F44;   /* Primario (links, títulos, énfasis) */
  --secondary:#3AAFA9; /* Teal (botones principales, detalles fríos) */
  --accent:#F39200;    /* Naranja (llamados de atención, badges) */

  --border:#E3EDF2;    /* Bordes suaves */
  --success:#1B9E77;   /* Verde para estados OK */
  --danger:#D64545;    /* Rojo para estados críticos */

  /* Radio y sombras reusables */
  --radius: 18px;
  --radius-lg: 22px;
  --shadow-sm: 0 4px 12px rgba(14,47,68,.08);
  --shadow-md: 0 10px 28px rgba(14,47,68,.14);
  --shadow-lg: 0 24px 48px rgba(14,47,68,.18);
  --ring: 0 0 0 3px rgba(58,175,169,.25);
  /* Safe-area (para iPhone con notch) */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  /* Altura actual de la barra inferior (dinámica por JS) */
  --bbar-h: 64px;
  /* Altura total de elementos fijos móviles (barra inferior + barra de búsqueda si está visible) */
  --total-fixed-height: 64px;
  /* Altura del recuadro de chat unificada (se adapta sin estirarse de más) */
  --chat-h: clamp(480px, 70vh, 760px);
  /* Escalas tipográficas fluidas */
  --step--2: clamp(.68rem, calc(.70rem + -.02vw), .66rem);
  --step--1: clamp(.78rem, calc(.74rem + .10vw), .82rem);
  --step-0: clamp(.92rem, calc(.86rem + .28vw), 1rem);
  --step-1: clamp(1.05rem, calc(.98rem + .42vw), 1.25rem);
  --step-2: clamp(1.32rem, calc(1.16rem + .75vw), 1.6rem);
  --step-3: clamp(1.58rem, calc(1.34rem + 1.00vw), 2rem);
  --step-4: clamp(1.98rem, calc(1.60rem + 1.60vw), 2.5rem);
  --focus-outline: 2px solid var(--secondary);
  --focus-outline-offset: 2px;
  --transition-base: .18s cubic-bezier(.4,0,.2,1);
}
/* --------------------
   Mejoras visuales generales
   -------------------- */
.shadow-lg { box-shadow: 0 24px 48px rgba(14,47,68,.18)!important; }
.shadow-md { box-shadow: 0 10px 28px rgba(14,47,68,.14)!important; }
.shadow-sm { box-shadow: 0 4px 12px rgba(14,47,68,.08)!important; }

.hero-main {
  background: linear-gradient(120deg, #eef7f7 60%, #fff 100%);
  border-radius: var(--radius-lg);
  padding: 32px 24px 24px 24px;
  transition: box-shadow .18s, transform .18s;
}
.tracking-step { transition: fill 0.4s, stroke 0.4s; filter: drop-shadow(0 2px 8px #0001); }
.tracking-step.active { fill: var(--accent); stroke: var(--accent); }
.tracking-step.done { fill: var(--secondary); stroke: var(--secondary); }
#tracking-truck { transition: transform 0.4s; }
.card:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 18px 36px rgba(58,175,169,.18);
}

.chat-wrapper {
  border-radius: var(--radius-lg);
  background: #f8fcfd;
}

.list li {
  transition: box-shadow .15s, transform .15s;
}
.list li:hover {
  transform: scale(1.01);
  box-shadow: 0 8px 24px rgba(58,175,169,.10);
}

body, html {
  scroll-behavior: smooth;
}

/* Preferencias de esquema de color del usuario (preparado para modo oscuro futuro) */
@media (prefers-color-scheme: dark) {
  :root {
    color-scheme: light; /* Forzado a light por consistencia de marca */
  }
}

/* Enlaces de salto para accesibilidad */
.skip-link{ position: absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus{ position:fixed; left:12px; top:12px; width:auto; height:auto; padding:10px 14px; background:#fff; border:2px solid var(--secondary); border-radius:12px; z-index:3000; box-shadow: var(--shadow-md); }

@media (max-width: 600px) {
  .hero-main {
    padding: 16px 10px 14px 10px;
    font-size: 1rem;
  }
  .hero-title {
    font-size: 1.25rem;
  }
  .section-title {
    font-size: 1.05rem;
    gap: 6px;
  }
  .hero-btn { width: 100%; }
}

/* Reset mínimo y base tipográfica */
*{box-sizing:border-box}
html,body{height:100%; overflow:hidden}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
  color:var(--text);
  background:
    radial-gradient(900px 400px at -10% 110%, rgba(58,175,169,.10), transparent 60%),
    radial-gradient(1200px 600px at 80% -10%, rgba(243,146,0,.12), transparent 60%),
    var(--bg);
  font-size: var(--step-0);
  line-height: 1.45;
}

/* Layout principal */
#app{display:flex; flex-direction:column; height:100vh; max-width:980px; margin:0 auto}

.brand{display:flex; gap:12px; align-items:center}
.logo{width:40px; height:40px; object-fit:contain; border-radius:8px; background:#fff}
.app-name{margin:0; font-size:var(--step-3); color:var(--primary); line-height:1}
.tagline{margin:0; color:var(--accent); font-size:12px; font-weight:700}
.user-badge{color:var(--muted); font-size:14px}

/* Contenedor de vistas */
#view-container{flex:1; padding:clamp(14px,2.2vw,22px); padding-bottom: calc(var(--bbar-h) + 110px + var(--safe-bottom)); overflow:auto; }
/* Ocultar visualmente la barra de scroll del contenedor principal en todas las vistas (manteniendo desplazamiento) */
#view-container{ scrollbar-width: none; -ms-overflow-style: none; }
#view-container::-webkit-scrollbar{ width: 0; height: 0; }
/* Vista conversaciones: permitir que los paneles internos gestionen su propio scroll sin bloquear el wheel */
.view.active[data-route="conversaciones"]{ display:flex; flex-direction:column; min-height:0; }
.view.active[data-route="conversaciones"] .chat-wrapper{ flex:1 1 auto; display:grid; grid-template-columns: 1fr; height:auto; max-height:calc(100vh - (var(--bbar-h) + 120px)); margin-bottom: calc(var(--bbar-h) + 12px); overflow:hidden; }

/* En la ruta de conversaciones, no scrollear el contenedor general */
/* Conversaciones: ahora queremos scroll general igual que otras vistas */
body.route-conversaciones #view-container{ overflow:auto; padding-bottom: calc(var(--bbar-h) + 90px); }
.chat-main{ display:flex; flex-direction:column; }
.chat-box.big{ flex:1; overflow:auto; overscroll-behavior:contain; }

/* Animación de vistas */
.view{display:none; animation:fade .15s ease-out}
.view.active{display:block}
@keyframes fade{from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none}}

/* --------------------
   Cards (tarjetas de home y list items)
   -------------------- */
.cards{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; margin-bottom: 28px}
.card{
  background:var(--card);
  border:1px solid var(--border);
  color:var(--text);
  border-radius: var(--radius-lg);
  padding:16px;
  box-shadow: var(--shadow-sm); /* sombra leve */
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  position: relative;
  cursor: pointer;
}
.card:hover{
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  border-color: rgba(58,175,169,.35);
}
.card:active{ transform: translateY(0); }
.card h3{ margin: 6px 0 6px 0; }
.card .card-desc{ margin: 0 0 10px 0; color: var(--muted); font-size: 0.95rem; }

/* --------------------
   Botones
   -------------------- */
.btn{
  --btn-bg:#fff; --btn-border:var(--border); --btn-color:var(--primary);
  border:1px solid var(--btn-border); background:var(--btn-bg); color:var(--btn-color);
  padding:12px clamp(14px,2vw,20px); border-radius:14px; cursor:pointer;
  font-weight:600; letter-spacing:.2px; font-size:var(--step--1);
  transition: background var(--transition-base), color var(--transition-base), transform .14s ease, box-shadow .18s ease, border-color var(--transition-base);
  box-shadow: 0 1px 0 rgba(14,47,68,.05);
  position:relative;
}
.btn:hover{ transform: translateY(-2px); box-shadow: var(--shadow-sm); }
.btn:active{ transform: translateY(0); box-shadow: 0 1px 0 rgba(14,47,68,.05); }
.btn:focus-visible{ outline: var(--focus-outline); outline-offset: var(--focus-outline-offset); }
.btn-primary{
  --btn-bg: linear-gradient(135deg, var(--accent), #ffae33);
  --btn-border: transparent;
  --btn-color:#fff;
  box-shadow: 0 10px 22px -4px rgba(243,146,0,.40), 0 4px 10px -2px rgba(243,146,0,.35);
}
.btn-primary:hover{ filter: brightness(1.04) saturate(1.05); }
.btn-primary:active{ filter: brightness(.97); }
.btn-ghost{ background:transparent; }
.btn[disabled], .btn:disabled{ opacity:.55; cursor:not-allowed; filter:grayscale(.2); box-shadow:none; }

/* --------------------
   Formularios e inputs
   -------------------- */
.form{display:grid; gap:12px; max-width:520px}
.form.small{max-width:420px}
.form input, .form textarea{padding:12px 14px; border-radius:12px; border:1px solid var(--border); background:#fff; color:var(--text); font-size:var(--step--1)}
.publish-form input, .publish-form textarea, .publish-form select { line-height:1.35; padding:14px 16px; }
.form input::placeholder, .form textarea::placeholder{color:#94a6b2}
.form input, .form textarea, .chat-input input, select, #chat-search{
  transition: box-shadow .15s ease, border-color .15s ease, background .15s ease;
  border-radius: 14px;
}
.form input:focus, .form textarea:focus, .chat-input input:focus, select:focus, #chat-search:focus{
  outline: none; box-shadow: var(--ring); border-color: rgba(58,175,169,.45);
}
.roles{border:1px dashed var(--border); padding:10px; border-radius:12px}
.radio{display:block; margin:6px 0}

/* --------------------
   Listas
   -------------------- */
.list{list-style:none; padding:0; margin:8px 0 28px 0; display:grid; gap:10px}
.list li{
  background:var(--card); border:1px solid var(--border); border-radius: var(--radius);
  padding:12px; color:var(--text); box-shadow: var(--shadow-sm);
}
.list li .title{font-weight:700; color:var(--primary)}
.list li .subtitle{color:var(--muted); font-size:13px}
.list li .chip{display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; background:#eef6f7; border:1px solid var(--border); color:var(--primary)}
.list li .chip.ok{background:#eafaf2; border-color:#d7f0e0; color:#15803d}
.list li .chip.warn{background:#fff5e6; border-color:#ffe6c2; color:#a15b00}
.list li:hover{ box-shadow: var(--shadow-md); }
.row{display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:wrap}
.badge{font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); color:#fff; background:var(--secondary)}
.badge-pill{display:inline-block; min-width:18px; padding:2px 6px; border-radius:999px; font-size:12px;
  background:var(--accent); color:#ffffff; font-weight:700; text-align:center;}

/* --------------------
   Chat
   -------------------- */
.chat-wrapper{display:grid; grid-template-columns: 320px 1fr; gap:16px; height:calc(100vh - 170px); min-height:520px; max-height:calc(100vh - 120px); overflow:hidden; }
.chat-sidebar{background:var(--card); border:1px solid var(--border); border-radius:var(--radius-lg); display:flex; flex-direction:column; box-shadow: var(--shadow-sm); height:100%; min-height:0; overflow:hidden}
.chat-sidebar-header{padding:12px; border-bottom:1px solid var(--border); display:grid; gap:8px}
.thread-list{list-style:none; margin:0; padding:0; overflow:auto; -webkit-overflow-scrolling: touch; display:grid; gap:6px; flex:1 1 auto; min-height:0;}
.thread-item{display:flex; align-items:center; gap:12px; padding:12px; border:none; border-radius:14px; cursor:pointer; transition: background .15s ease}
.thread-item{ min-height: 48px; }
.thread-item:hover{background:#eef6f7}
.thread-title{font-weight:700; color:var(--primary); overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
.thread-sub{color:var(--muted); font-size:12px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
.thread-badge{margin-left:auto}

.chat-main{background:var(--card); border:1px solid var(--border); border-radius:var(--radius-lg); display:flex; flex-direction:column; box-shadow: var(--shadow-sm); overflow:hidden; height: 100%; min-height:0}
.chat-main-header{padding:12px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; position: sticky; top:0; background:var(--card); z-index:1}
.chat-main-header #chat-title{ font-size:16px; font-weight:600; margin:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.chat-main-header .chat-main-left{ min-width:0; }
.chat-main-header .chat-main-actions{ flex:0 0 auto; }
.chat-box.big{min-height:0; flex:1; overflow:auto; -webkit-overflow-scrolling: touch; padding:16px; padding-bottom: 120px; display:grid; gap:10px; background:#fbfdfe; border-radius:16px; box-shadow: inset 0 1px 0 rgba(14,47,68,.05); position: relative}

/* Fades superiores/inferiores para indicar contenido desplazable */
.chat-box.big::before,
.chat-box.big::after{
  content: "";
  position: absolute;
  left: 0; right: 0;
  height: 18px;
  pointer-events: none;
  opacity: 0;
  transition: opacity .15s ease;
}
.chat-box.big::before{
  top: 0;
  background: linear-gradient(to bottom, #fbfdfe 30%, rgba(251,253,254,0));
  border-top-left-radius: 16px; border-top-right-radius: 16px;
}
.chat-box.big::after{
  bottom: 0;
  background: linear-gradient(to top, #fbfdfe 30%, rgba(251,253,254,0));
  border-bottom-left-radius: 16px; border-bottom-right-radius: 16px;
}
.chat-box.big.show-top-fade::before{ opacity: 1; }
.chat-box.big.show-bottom-fade::after{ opacity: 1; }
.bubble{max-width:70%; padding:10px 12px; border:1px solid var(--border); border-radius:14px; font-size:15px; line-height:1.3; position:relative; overflow-wrap:anywhere; word-break:break-word}
.bubble.me{margin-left:auto; background:#e3f3f1; border-color:#cceae7}
.bubble.other{margin-right:auto; background:#fff}
.bubble .bubble-reply{font-size:12px; color:var(--muted); padding:6px 8px; border-left:3px solid var(--secondary); margin:-6px -6px 6px -6px; background:#f4faf9; border-radius:10px}
.bubble .attachments{display:flex; gap:6px; flex-wrap:wrap; margin-top:6px}
.bubble .attachments img{max-width:160px; max-height:120px; border-radius:10px; border:1px solid var(--border)}
.reply-bar{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 12px; border-bottom:1px solid var(--border); background:#fff}
.reply-bar .reply-snippet{font-size:12px; color:var(--muted)}
.attach-previews{display:flex; gap:8px; padding:8px 12px; flex-wrap:wrap}
.attach-previews img{max-width:120px; max-height:96px; border-radius:10px; border:1px solid var(--border)}
.context-menu{position:absolute; background:#fff; border:1px solid var(--border); border-radius:8px; box-shadow: var(--shadow-sm); display:grid;}
.context-menu button{background:transparent; border:none; text-align:left; padding:8px 12px; cursor:pointer}
.context-menu button:hover{background:#f2f7f7}
.avatar{width:36px; height:36px; border-radius:999px; background:#e9f3f6; display:grid; place-items:center; font-weight:800; border:1px solid var(--border); color:var(--primary)}
.typing-indicator{ font-size:12px; color: var(--muted); padding: 4px 16px; }
.chat-input{display:flex; gap:8px; margin-top:auto; padding:12px; border-top:1px solid var(--border); background: #fff; position:sticky; bottom: 0; z-index: 2; box-shadow: 0 -6px 18px rgba(14,47,68,.06)}
.chat-input textarea{flex:1; padding:12px 14px; border-radius:12px; border:1px solid var(--border); background:#fff; color:var(--text); resize:none; max-height: 160px; min-height: 40px}
.chat-input textarea::placeholder{color:#94a6b2}
.chat-input #btn-attach{ border:1px solid var(--border); background:#fff; }
.chat-input .btn-primary{ box-shadow: 0 8px 18px rgba(243,146,0,.25); }

/* Ocultar barra de scroll (se mantiene el desplazamiento interno) */

/* Mostrar scrollbars de forma sutil (mejor UX en Windows) */
.chat-box.big{ scrollbar-width: thin; -ms-overflow-style: auto; }
.chat-box.big::-webkit-scrollbar{ width: 10px; height: 10px; }
.chat-box.big::-webkit-scrollbar-thumb{ background: rgba(14,47,68,.28); border-radius: 8px; }
.chat-box.big::-webkit-scrollbar-track{ background: transparent; }

.thread-list{ scrollbar-width: thin; -ms-overflow-style: auto; position: relative; overflow:auto !important; touch-action: pan-y; }
.thread-list::-webkit-scrollbar{ width: 10px; height: 10px; }
.thread-list::-webkit-scrollbar-thumb{ background: rgba(14,47,68,.28); border-radius: 8px; }
.thread-list::-webkit-scrollbar-track{ background: transparent; }

/* Fades para la lista de hilos */
.thread-list::before,
.thread-list::after{
  content: "";
  position: absolute;
  left: 0; right: 0;
  height: 28px; /* un poco más alto para indicar scroll */
  pointer-events: none; /* no bloquear wheel ni drag */
  opacity: 0;
  transition: opacity .18s ease;
  z-index: 1;
}
.thread-list::before{ top:0; background: linear-gradient(to bottom, #ffffff 40%, rgba(255,255,255,0)); border-top-left-radius: 16px; border-top-right-radius: 16px; }
.thread-list::after{ bottom:0; background: linear-gradient(to top, #ffffff 40%, rgba(255,255,255,0)); border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; }
.thread-list.show-top-fade::before{ opacity:1 }
.thread-list.show-bottom-fade::after{ opacity:1 }

/* --------------------
   Selects
   -------------------- */
select{padding:12px 14px; border-radius:12px; border:1px solid var(--border); background:#fff; color:var(--text); font-size:var(--step--1)}
select option{color:#0E2F44; background:#fff}

/* --------------------
   Tracking
   -------------------- */
/* Limpieza: tracking clásico eliminado, ahora se usa SVG inline en app.js */

/* --------------------
   Bottom navigation
   -------------------- */
.bottombar{
  position:fixed; left:0; right:0; bottom:0; display:none; justify-content:space-around; gap:clamp(6px,2vw,14px);
  padding:12px clamp(10px,4vw,34px); padding-bottom: calc(12px + var(--safe-bottom));
  border-top:1px solid var(--border); background:linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.95)); backdrop-filter:blur(14px) saturate(1.3);
  box-shadow: 0 -8px 28px -4px rgba(14,47,68,.08), 0 -2px 6px rgba(14,47,68,.08);
  z-index:1000;
}
.bottombar.visible{display:flex}
.tab{background:transparent; border:none; font-size:clamp(20px,4.5vw,24px); color:var(--primary); padding:10px clamp(14px,2vw,22px); border-radius:14px; cursor:pointer; font-weight:700; transition: background var(--transition-base), transform .14s ease, box-shadow var(--transition-base); position:relative; }
.tab:hover{ background:#f0f6f7; transform: translateY(-2px); }
.tab:active{ transform:translateY(0); }
.tab:focus-visible{ outline: var(--focus-outline); outline-offset: 4px; }
.tab.active{background: linear-gradient(180deg, #ffffff, #ffe6c2); box-shadow: inset 0 1px 0 rgba(255,255,255,.7), 0 8px 18px rgba(14,47,68,.10); }

/* --------------------
   Responsivo
   -------------------- */
/* Mostrar solo lista o solo chat en conversaciones (todas las resoluciones) */
/* Nueva lógica: usamos tarjetas (#threads-cards) y panel (#chat-area).  */
body.route-conversaciones #threads-cards{ display:grid; }
body.route-conversaciones.chat-has-active #threads-cards{ display:none; }
body.route-conversaciones #chat-area{ display:none; }
body.route-conversaciones.chat-has-active #chat-area{ display:block; }
/* Ajustes de panel chat en nueva disposición */
#chat-area .chat-panel{ background: var(--card); border:1px solid var(--border); border-radius: var(--radius-lg); padding:0; }
#chat-area .chat-main-header{ border-bottom:1px solid var(--border); }
/* Botón atrás visible cuando hay chat activo */
.chat-main-left{ display:flex; align-items:flex-start; gap:8px }
body.route-conversaciones.chat-has-active #chat-back{ display:inline-flex !important }

#tracking-search{max-width:220px}
#tracking-list .row .btn{padding:8px 12px}

/* Tracking list tweaks */
#tracking-list li{padding:14px}
#tracking-list li .row:first-child{margin-bottom:6px}


/* limpieza: selector suelto 'hero' eliminado */

.view[data-route="home"] .cards { margin-top: 20px; }

.cards .card { display:flex; flex-direction:column; }

.cards .card .btn-ghost { align-self:flex-end; background: var(--accent); color:#fff; }
.cards .card .btn-ghost:hover { filter: brightness(1.05); }
/* Badge dentro de la tarjeta */
.card-badge{ position:absolute; top:12px; right:12px; }

/* Hace toda la tarjeta clickeable sin interferir con el botón interno */
.cards .card[data-nav]::after{
  content: ""; position:absolute; inset:0; border-radius: var(--radius-lg);
}
.cards .card[data-nav] .btn-ghost{ position: relative; z-index: 1; }

@media (max-width: 720px){
  #view-container{ padding: clamp(10px,3vw,16px); padding-bottom: calc(var(--total-fixed-height) + 90px + var(--safe-bottom)); }
  .cards{ grid-template-columns: 1fr 1fr; gap: 12px; }
  .card{ padding: 12px; border-radius: 16px; }
  .card h3{ font-size: 1rem; }
  .card .card-desc{ font-size: .9rem; }
  .btn{ padding: 10px 12px; border-radius: 12px; }
  .btn-primary{ box-shadow: 0 8px 16px rgba(243,146,0,.22); }
  .bottombar{ padding: 10px; }
  .tab{ font-size: 20px; }
}

@media (max-width: 420px){
  .cards{ grid-template-columns: 1fr; gap: 10px; }
  .card{ padding: 12px; }
  .card .btn-ghost{ width: 100%; align-self: stretch; text-align: center; }
}

/* Compacto para móviles ~390px de ancho (iPhone 12/13/14) */
@media (max-width: 400px){
  html, body { font-size: 15px; }
  .topbar-inner{ padding: 8px 10px; }
  .app-name{ font-size: 20px; }
  .tagline{ display:none; }
  #view-container{ padding: 10px; padding-bottom: calc(var(--total-fixed-height) + 72px + var(--safe-bottom)); }
  .hero-main{ padding: 12px; }
  .hero-title{ font-size: 1.1rem; }
  .section-title{ font-size: 1rem; }
  .cards{ grid-template-columns: 1fr; gap: 10px; }
  .card{ padding: 12px; border-radius: 14px; }
  .list{ gap: 8px; }
  .list li{ padding: 10px; }
  .btn{ padding: 10px clamp(12px,4vw,16px); border-radius: 12px; }
  .btn-primary{ box-shadow: 0 6px 14px rgba(243,146,0,.22); }
  .bottombar{ padding: 8px 10px; padding-bottom: calc(8px + var(--safe-bottom)); }
  .tab{ font-size: 20px; padding: 10px 14px; }
  /* Login/Publicar márgenes y paddings más compactos */
  .login-box{ margin-top: 28px; padding: 20px 14px; }
  .publish-box{ margin-top: 24px; padding: 20px 14px; }
  /* Chat compacto */
  .chat-wrapper{ gap: 10px; }
  .chat-main-header{ padding: 10px 12px; }
  .chat-box.big{ padding: 12px; }
  .chat-input{ padding: 10px; }
  .bubble{ font-size: 14px; }
}

/* Header full-width con contenedor interno */
.topbar{
  position: sticky;  /* queda pegado arriba al hacer scroll */
  top: 0;
  z-index: 1000;
  width: 100%;
  background: #fff;
  border-bottom: 1px solid var(--border);
  box-shadow: 0 4px 18px rgba(14,47,68,.06);
  padding-top: var(--safe-top);
}
.topbar-inner{
  max-width: min(1240px, 94vw); /* contenedor fluido */
  margin: 0 auto;
  padding: clamp(10px,1.8vw,20px) clamp(14px,3vw,32px);
  display:flex; align-items:center; justify-content:space-between;
}

/* Ajustes responsivos */
@media (max-width: 600px){
  .topbar-inner{ padding: 12px 14px; }
  .brand{ gap: 10px; }
  .app-name{ font-size: 22px; }
  .tagline{ font-size: 11px; }
  .user-badge{ font-size: 13px; }
}

/* Como el header ya no está dentro de #app, mantenemos padding dinámico para la barra inferior */

/* Mejoras adicionales para scroll móvil */
@media (max-width: 720px) {
  /* Asegurar que el contenido sea scrolleable */
  #view-container {
    min-height: calc(100vh - var(--total-fixed-height) - var(--safe-bottom) - 90px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch; /* Scroll suave en iOS */
  }
  
  /* Mejorar el scroll en conversaciones */
  body.route-conversaciones #view-container {
    padding-bottom: calc(var(--total-fixed-height) + 120px + var(--safe-bottom));
  }
}

/* Estilos base para el contenedor principal */
#view-container{ 
  padding-top: 18px; 
  padding-bottom: calc(var(--total-fixed-height) + 110px + var(--safe-bottom)); 
}

/* Utilidades */
.visually-hidden{ position:absolute !important; width:1px !important; height:1px !important; padding:0 !important; margin:-1px !important; overflow:hidden !important; clip:rect(0 0 0 0) !important; white-space:nowrap !important; border:0 !important; }
.container{ width:100%; max-width: min(1180px, 94vw); margin-inline:auto; }
.flow > * + *{ margin-top: var(--flow-space, 1rem); }

/* Mejoras de contraste para badges sobre fondo claro */
.badge{ background: linear-gradient(135deg, var(--secondary), #2f8f8b); }
.badge-pill{ background: var(--accent); }

/* Ajuste de animación de hover general accesible */
@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{ animation-duration: .01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
}

/* --------------------
   Publicar carga mejorado
   -------------------- */
.publish-box {
  max-width: 420px;
  margin: 38px auto 0 auto;
  background: var(--card);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  padding: 32px 28px 28px 28px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;
}
.publish-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 8px;
  text-align: center;
}
.publish-form {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 18px; /* más aire vertical */
  line-height: 1.35;
}
.publish-form label {
  display: flex;
  align-items: flex-start; /* icono alineado arriba si hay múltiples líneas */
  gap: 10px; /* más separación icono-texto */
  font-weight: 500;
  line-height: 1.25;
}
.publish-form label span {
  font-size: 1.25em;
  margin-top: 2px;
  flex-shrink: 0;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.12));
}
/* Tipos de publicación (Contenedor / Granel / Carga general) */
.publish-types { display:flex; gap:8px; margin:4px 0 8px 0; }
.publish-types .pt-btn { background:#f2f5f6; border:1px solid var(--border); padding:6px 14px; border-radius:24px; cursor:pointer; font-weight:600; font-size:.85rem; letter-spacing:.3px; transition:.15s background,color,box-shadow,border-color; }
.publish-types .pt-btn:hover { background:#fff; }
.publish-types .pt-btn.active { background:var(--accent); color:#fff; border-color:var(--accent); box-shadow:0 2px 6px rgba(0,0,0,.15); }
.publish-variant { border:1px dashed var(--border); padding:18px 20px; border-radius:18px; background:linear-gradient(135deg,#ffffff,#f4fafc); display:flex; flex-direction:column; gap:16px; }
.publish-variant + .publish-variant { margin-top:4px; }
.publish-variant[hidden]{ display:none !important; }
.publish-variant label { gap:10px; }
.publish-variant:has(select[disabled]) { opacity:.55; }
@media (max-width:640px){
  .publish-types { flex-wrap:wrap; }
  .publish-types .pt-btn { flex:1 1 auto; text-align:center; }
}
.publish-btn {
  width: 100%;
  margin-top: 10px;
  font-size: 1.1rem;
  padding: 14px 0;
}
.publish-preview {
  background: #f6fbfa;
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 12px 16px;
  margin: 8px 0 0 0;
  color: var(--text);
  font-size: 1rem;
  box-shadow: var(--shadow-sm);
  display: none;
}
/* Previsualización de archivos en Publicar */
.file-uploader{ display:flex; flex-direction:column; gap:8px; }
.file-drop{ border:1.5px dashed var(--border); background:#fcfeff; border-radius:14px; padding:14px; cursor:pointer; transition: border-color .15s, background .15s, box-shadow .15s; }
.file-drop:hover{ border-color: rgba(58,175,169,.5); box-shadow: 0 6px 16px rgba(58,175,169,.08); }
.file-drop.dragover{ background:#f0fbfa; border-color: var(--secondary); box-shadow: 0 8px 18px rgba(58,175,169,.15); }
.file-drop-inner{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
.file-icon{ font-size:20px }
.file-text{ display:flex; flex-direction:column; gap:2px }
.file-previews{ display:flex; gap:10px; flex-wrap:wrap; margin:6px 0 0 0; }
.file-card{ position:relative; border:1px solid var(--border); border-radius:12px; background:#fff; box-shadow: var(--shadow-sm); padding:6px; display:flex; align-items:center; gap:8px; min-width:160px; max-width: 220px; }
.file-card img{ display:block; max-width:100px; max-height:80px; border-radius:8px; border:1px solid var(--border); background:#f7fbfd }
.file-card .file-info{ display:flex; flex-direction:column; min-width:0; }
.file-card .file-name{ font-size:12px; color:var(--text); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width: 100px; }
.file-card .file-meta{ font-size:11px; color:var(--muted); }
.file-card .file-del{ position:absolute; top:4px; right:4px; background:#fff; border:1px solid var(--border); border-radius:999px; cursor:pointer; width:24px; height:24px; display:grid; place-items:center; box-shadow: var(--shadow-sm); }
.file-card .file-del:hover{ background:#f6faf9 }
.file-chip{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:#eef6f7; border:1px solid var(--border); color:var(--primary); font-size:12px }
.attachments{ display:flex; gap:6px; flex-wrap:wrap; margin-top:6px }
.attachments.small img{ max-width:90px; max-height:70px; border-radius:8px; border:1px solid var(--border) }
.attachments img{ max-width:160px; max-height:120px; border-radius:10px; border:1px solid var(--border) }

@media (max-width: 600px){
  .file-card{ min-width: 46%; max-width: 100%; }
  .file-card img{ max-width: 76px; max-height: 64px; }
}
@media (max-width: 600px) {
  .publish-box {
    max-width: 98vw;
    padding: 18px 6px 14px 6px;
  }
  .publish-title { font-size: 1.1rem; }
  .bottombar{ padding: 10px; padding-bottom: calc(10px + var(--safe-bottom)); }
  .tab{ font-size: 22px; padding: 12px 16px; }
  .card-badge{ top:8px; right:8px; }
}
/* --------------------
   Login mejorado y header alineado
   -------------------- */
.login-box {
  max-width: 370px;
  margin: 48px auto 0 auto;
  background: var(--card);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  padding: 38px 32px 32px 32px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;
}
.login-avatar {
  width: 72px;
  height: 72px;
  border-radius: 50%;
  background: #eaf1f6;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 12px rgba(58,175,169,.10);
  margin-bottom: 8px;
}
.login-avatar img {
  width: 54px;
  height: 54px;
  object-fit: contain;
  border-radius: 50%;
}
.login-title {
  font-size: 1.7rem;
  font-weight: 700;
  color: var(--primary);
  margin: 0;
  text-align: center;
}
.login-desc {
  color: var(--muted);
  font-size: 1rem;
  text-align: center;
  margin-bottom: 10px;
}
.login-form {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.login-btn {
  width: 100%;
  margin-top: 10px;
  font-size: 1.1rem;
  padding: 14px 0;
}
.brand-left {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-left: 0;
}
.topbar-actions {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-right: 0;
}
.btn-logout {
  font-size: 15px;
  padding: 8px 16px;
}
@media (max-width: 600px) {
  .login-box {
    max-width: 98vw;
    padding: 22px 8px 18px 8px;
  }
  .login-title {
    font-size: 1.2rem;
  }
  .topbar-inner {
    padding: 8px 4px;
  }
  .brand-left {
    gap: 8px;
  }
  .topbar-actions {
    gap: 6px;
  }
  .logo {
    width: 32px;
    height: 32px;
  }
}

/* Microanimación para badge cuando cambia el conteo */
.pulse-badge { animation: pulse-badge .6s ease-out; }
@keyframes pulse-badge {
  0% { transform: scale(1); filter: brightness(1); }
  30% { transform: scale(1.12); filter: brightness(1.05); }
  60% { transform: scale(0.98); }
  100% { transform: scale(1); filter: brightness(1); }
}

/* --------------------
   Avisos centrados (console overlay)
   -------------------- */
.notice-overlay{ position: fixed; inset: 0; background: rgba(14,47,68,.32); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 18px; }
.notice-overlay.show{ display: flex; }
.notice-modal{ width: min(92vw, 420px); background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
.notice-modal .notice-head{ padding: 12px 16px; font-weight: 800; letter-spacing: .2px; background: #f6fbfa; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
.notice-modal .notice-head.warn{ background: #fff7ed; }
.notice-modal .notice-head.error{ background: #fff1f1; }
.notice-modal .notice-body{ padding: 14px 16px; font-size: 15px; line-height: 1.35; white-space: pre-wrap; word-break: break-word; }
.notice-modal .notice-actions{ padding: 12px 16px; display: flex; gap: 10px; justify-content: flex-end; background: #fff; border-top: 1px solid var(--border); }
.notice-modal .btn-ack{ background: var(--secondary); color: #fff; border: none; padding: 10px 14px; border-radius: 12px; cursor: pointer; box-shadow: 0 8px 18px rgba(58,175,169,.25); font-weight: 700; }
.notice-modal .btn-ack:hover{ filter: brightness(1.05); }